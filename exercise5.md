# Задание №5. PowerShell
----------------------
### 1. Что такое PowerShell?

**PowerShell** — это кроссплатформенное решение для автоматизации задач, которое включает оболочку командной строки, скриптовый язык и платформу управления конфигурацией. **PowerShell** поддерживается в Windows, Linux и macOS.

**PowerShell** — это современная командная оболочка, в которой реализованы лучшие возможности других популярных оболочек. В отличие от большинства оболочек, которые только принимают и возвращают текст, **PowerShell** принимает и возвращает объекты ```.NET```. Это решение предлагает ***следующие возможности***:
- надежный журнал командной строки;
- заполнение нажатием клавиши ```TAB``` и подстановка команд;
- поддержка псевдонимов команд и параметров;
- создание конвейера для объединения команд;
- система справки в консоли, похожая на страницы ```man``` в Unix.

### 2. Какие возможности имеет PowerShell?

**PowerShell** - это мощный инструмент командной строки, который предоставляет множество возможностей для автоматизации административных задач и управления компьютером. 
Вот некоторые из наиболее распространенных возможностей **PowerShell**:

- управление учетными записями пользователей, включая создание, изменение и удаление, а также настройку прав доступа.
- управление файлами и папками, включая копирование, перемещение, удаление и создание новых файлов и папок.
- управление службами на компьютере, включая запуск, остановку, перезапуск и настройку служб.
- управление реестром Windows, что позволяет изменять и настраивать различные параметры системы.
- работа с сетевыми ресурсами и управление ими, включая доступ к файлам и папкам на других компьютерах в сети.
- работа с базами данных, включая подключение к базам данных и выполнение запросов.
- управление процессами, включая завершение, приостановление и возобновление процессов.
- работа с встроенными командлетами, которые предоставляют удобный способ выполнения административных задач.

Это лишь некоторые из возможностей **PowerShell** и он может быть использован в различных областях, таких как администрирование, разработка, тестирование и многое другое. 

### 3. Как открыть журнал событий в PowerShell?

Журнал событий **Windows PowerShell** можно просмотреть в **Просмотр событий** или с помощью командлет, на данный момент в Windows доступны два командлета для доступа к событиям в Event Log: ```Get-EventLog``` и ```Get-WinEvent```. 
В подавляющем большинстве случаев рекомендуется использовать именно ```Get-WinEvent```, т.к. он более производителен, особенно в сценариях обработки большого количества событий с удаленных компьютеров. Командлет ```Get-EventLog``` является устаревшим и использовался для получения логов в более ранних версиях Windows. Кроме того, ```Get-EventLog``` не поддерживается в современных версиях PowerShell Core 7.x. 
В журнале событий Windows PowerShell содержатся сведения об Windows PowerShell операциях, таких как запуск и остановка обработчика программы, а также запуск и остановка поставщиков Windows PowerShell. Также можно записывать в журнал сведения о командах Windows PowerShell.

### 4. Чем cmd отличается от PowerShell?

**CMD** и **PowerShell** - это две разные командные оболочки, которые используются для управления компьютером и выполнения различных задач.

**CMD** - это командная оболочка, которая была установлена вместе с операционной системой Windows и является более старой версией PowerShell. Она имеет простой интерфейс и позволяет выполнять команды в текстовом режиме. **CMD** также используется для запуска приложений и файлов, но не поддерживает многие функции PowerShell, такие как работа с объектами и использование сценариев.

**PowerShell** - это более современная и мощная командная оболочка. Она имеет более удобный интерфейс, поддерживает работу с объектами и имеет множество функций, таких как управление процессами, работа с файлами и многое другое. **PowerShell** также поддерживает сценарии и может использоваться для автоматизации задач и управления системой.

Таким образом, **CMD и PowerShell** имеют свои преимущества и недостатки, и выбор между ними зависит от конкретной задачи. Если нужно выполнять простые операции и работать с простыми командами, то **CMD** может быть достаточно. Однако, если нужно автоматизировать задачи или работать с более сложными операциями, то **PowerShell** может быть более подходящим выбором.

### 5. Какой командой в PowerShell можно просмотреть список доступных журналов событий?

#### Просмотр журнала событий Windows PowerShell:

- Полный список журналов событий в Windows можно получить с помощью команды ```Get-WinEvent -ListLog```

Для использования команды Get-WinEvent нужно запустить PowerShell с правами администратора (при запуске Get-WinEvent от имени пользователя вы не сможете получить доступ к некоторым логам, например, к Security). 
Для получения списка событий из определенного журнала, нужно указать его имя. Например: ```Get-WinEvent -LogName Application```
Чаще всего необходима информация из журналов System, Application, Security или Setup. Но вы можете указать и другие журналы. 


- Также для просмотра всех классических журналов событий можно использовать команду ```Get-EventLog -List```. Просмотр определенного журнала:

1. Открытие журнала событий **"Приложение"** - ```Get-WinEvent-LogName Application```
2. Открытие журнала событий **"Система"** - ```Get-WinEvent-LogName System```
3. Открытие журнала событий **"Безопасность"** - ```Get-WinEvent-LogName Security```
4. Открытие журнала событий **"Журналы служб"** - ```Get-WinEvent-LogName "Service Logs"```

#### Просмотр данных журнала PowerShell в системном журнале на Linux:

Среду PowerShell можно установить в различных дистрибутивах Linux. Большинство платформ и дистрибутивов Linux имеют крупные выпуски каждый год и предоставляют диспетчер пакетов, который используется для установки PowerShell.

Протокол системного журнала хранит сообщения журнала в стандартизированном текстовом формате. Можно использовать любую служебную программу обработки текста для запроса или просмотра содержимого системного журнала.

По умолчанию системный журнал записывает записи журнала в следующее расположение:

- в дистрибутивах на основе Debian, включая Ubuntu: ```/var/log/syslog```
- в дистрибутивах на основе RHEL: ```/var/log/messages```

В следующем примере команда используется cat для запроса записей системного журнала PowerShell в Ubuntu.

```cat /var/log/syslog | grep -i powershell```

#### Просмотр данных журнала PowerShell в macOS:

PowerShell записывает журналы в единую систему ведения журналов Apple— функцию macOS, которая позволяет собирать и хранить журналы системы и приложений в одном централизованном расположении.

Единая система ведения журнала Apple хранит сообщения журнала в двоичном формате. Используйте консольное приложение или средство ведения журнала для запроса единой системы ведения журнала для записей PowerShell.

- **Просмотр данных журнала PowerShell в консольном приложении в macOS**:

Консольное приложение в macOS — это служебная программа, которая предоставляет графический пользовательский интерфейс для просмотра данных журнала. Консольное приложение по умолчанию входит в состав macOS, и его можно получить, открыв папку **Служебные программы** в папке **Приложения**.

Чтобы просмотреть данные журнала PowerShell в консольном приложении в macOS, выполняются следующие действия:

- Найти консольное приложение и запустить его.
- Выбрать имя компьютера в разделе **Устройства**.
- В поле **Поиск** ввести ```pwsh``` основной двоичный файл PowerShell и нажать клавишу **RETURN**.
- Изменить фильтр поиска с ```Any``` на ```Process```.
- Нажать **Запуск**.
- Запустить ```pwsh``` для создания сведений PowerShell для ведения журнала.

Идентификатор процесса для запущенного экземпляра PowerShell хранится в переменной ```$PID```. Производятся следующие действия, чтобы выполнить фильтрацию по определенному экземпляру процесса PowerShell в консольном приложении:
- Запустить экземпляр ```pwsh```.
- Выполнить команду ```$PID``` в экземпляре PowerShell, запущенном на предыдущем шаге, чтобы определить идентификатор процесса.
- Ввести идентификатор ```pwsh``` процесса в поле **Поиск** и нажать клавишу **RETURN**.
- Изменить фильтр поиска с ```Any``` на ```PID```.
- Нажать **Запуск**.
- Создать данные PowerShell для ведения журнала из экземпляра PowerShell, запущенного на первом шаге.

- **Просмотр данных журнала PowerShell из командной строки в macOS**:

Чтобы просмотреть данные журнала PowerShell из командной строки в macOS, используется команда ```log``` в терминале или другом ведущем приложении оболочки. Эти команды можно выполнять из **PowerShell**, оболочки ***Z (Zsh)** или **Bash**.

```log stream --process pwsh --level info``` - в данном примере ```log``` команда используется для отображения данных журнала в системе, которые происходят в режиме реального времени. Параметр ```process``` фильтрует данные журнала только для процесса ```pwsh``` . Параметр ```level``` отображает сообщения на указанном уровне и ниже.

### 6. Какой командой можно узнать текущую версию PowerShell?

Для того чтобы узнать текущую версию **PowerShell на Windows**, можно использовать команду ```Get-Host -Version```. Эта команда выводит информацию о версии PowerShell, установленной на компьютере.

Для проверки версии **PowerShell на macOS** можно использовать следующую команду - ```$PSVersionTable```. Эта команда выводит информацию о текущей версии PowerShell, включая версию, сборку и другие параметры.
